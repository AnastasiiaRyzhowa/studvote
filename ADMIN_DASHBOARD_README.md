# Дашборд качества образования для администратора

## Что было сделано

### 1. Обновлен административный дашборд качества

**Файл:** `/client/src/pages/Admin/QualityDashboard.jsx`

Создан полностью новый дашборд с современным дизайном на Tailwind CSS, включающий:

#### Структура дашборда:

1. **Панель фильтров** (закрепленная вверху страницы):
   - Каскадные фильтры: Факультет → Программа → Курс → Группа → Дисциплина → Преподаватель
   - Выбор периода: Неделя / Месяц / Семестр / Произвольный
   - Кнопка "Сбросить" для очистки всех фильтров
   - Кнопка "Применить фильтры"
   - Dropdown-меню "Экспортировать" с 3 опциями:
     - Excel (сырые данные)
     - PDF (сводный отчет)
     - PDF (детальный отчет)

2. **Вкладки**:
   - "Шаблонные опросы (Занятия)" - основная аналитика
   - "Свободные опросы" - пока в разработке

3. **Карточки сводной статистики** (4 виджета):
   - Опросов проведено
   - Охват студентов
   - Средний ИКОП
   - Проблемных дисциплин

4. **ИКОП по 5 критериям**:
   - Горизонтальная bar chart
   - Цветовая индикация (зеленый > 80, желтый 60-79, красный < 60)
   - Критерии: Актуальность, Понятность, Практика, Вовлеченность, Организация

5. **Динамика ИКОП**:
   - Линейный график с переключением периодов
   - Статистика: средний ИКОП, тренд, лучший/худший период

6. **Проблемные области**:
   - Таблица дисциплин с ИКОП < 60
   - Информация о преподавателе, группе, охвате

7. **Топ-3 рейтинги**:
   - Лучшие дисциплины
   - Лучшие преподаватели
   - С медалями и значениями ИКОП

8. **Облако слов**:
   - Топ-10 слов из комментариев студентов
   - С индикацией негативных слов

### 2. Обновлен бэкенд сервис

**Файл:** `/server/src/services/adminAnalyticsService.js`

Полностью переработан для поддержки новой структуры данных:
- Расчет сводной статистики
- ИКОП по 5 критериям
- Динамика ИКОП (по неделям/месяцам/семестрам)
- Поиск проблемных областей
- Топ дисциплин и преподавателей
- Анализ комментариев (токенизация, стоп-слова, frequency analysis)

### 3. Добавлены роуты для экспорта

**Файл:** `/server/src/routes/adminRoutes.js`

Добавлены новые endpoints:
- `POST /api/admin/export/excel` - экспорт в Excel
- `POST /api/admin/export/pdf/:type` - экспорт в PDF (summary/detailed)

> **Примечание:** Экспорт пока возвращает статус 501 (Not Implemented), требуется дополнительная реализация с использованием библиотек xlsx и pdfkit.

### 4. Обновлено меню навигации

**Файл:** `/client/src/components/Layout/Sidebar.js`

Изменен порядок пунктов меню для администратора:
- "Дашборд качества" теперь первый пункт (был "Качество образования")
- Изменена иконка с `assessment` на `dashboard`

## Как протестировать

### 1. Войти под учетной записью администратора

Убедитесь, что вы вошли в систему с ролью `admin`.

### 2. Перейти на дашборд качества

В боковом меню выберите **"Дашборд качества"** (первый пункт в админ-меню).

URL: `http://localhost:3000/admin/quality`

### 3. Проверить работу фильтров

1. Выберите факультет - должны подгрузиться программы
2. Выберите программу - должны подгрузиться курсы
3. Выберите курс - должны подгрузиться группы
4. И так далее по каскаду
5. Выберите период (неделя/месяц/семестр/произвольный)
6. Нажмите "Применить фильтры"

### 4. Проверить отображение данных

- Карточки сводки должны показывать актуальные значения
- Графики должны отрисоваться
- Таблица проблемных областей (если есть дисциплины с ИКОП < 60)
- Топ-3 рейтинги
- Облако слов (если есть комментарии)

### 5. Проверить вкладки

- Переключиться на "Свободные опросы" - должно показать заглушку "В разработке"
- Вернуться на "Шаблонные опросы"

### 6. Проверить экспорт (опционально)

> **Важно:** Функция экспорта пока не реализована полностью. При нажатии на кнопки экспорта будет показана ошибка "Экспорт временно недоступен".

Для полной реализации экспорта потребуется:
1. Установить библиотеки: `npm install xlsx pdfkit` в папке `server`
2. Реализовать логику генерации Excel и PDF в соответствующих endpoints

## Дизайн

Дашборд выполнен в современном стиле с использованием:
- **Tailwind CSS** для стилизации
- **Recharts** для графиков
- **Material Icons** для иконок
- **Gradient backgrounds** для визуальной привлекательности
- **Hover effects** и **transitions** для интерактивности

### Цветовая схема:

- **Primary:** Синий (#0167FC)
- **Success:** Зеленый/Изумрудный
- **Warning:** Желтый/Янтарный
- **Danger:** Красный

## Структура данных

### Формат ответа от API `/admin/analytics/quality-dashboard`:

```json
{
  "success": true,
  "data": {
    "summary": {
      "pollsCount": 245,
      "pollsChange": 12,
      "totalResponses": 1830,
      "coverage": 78,
      "coverageChange": 3,
      "avgIkop": 73,
      "ikopChange": -2,
      "problemDisciplines": 3,
      "problemChange": -1
    },
    "ikopByCriteria": [
      { "criterion": "Актуальность", "score": 72 },
      { "criterion": "Понятность", "score": 75 },
      { "criterion": "Практика", "score": 68 },
      { "criterion": "Вовлеченность", "score": 74 },
      { "criterion": "Организация", "score": 76 }
    ],
    "ikopDynamics": {
      "weekly": [],
      "monthly": [
        { "period": "Сентябрь", "ikop": 65 },
        { "period": "Октябрь", "ikop": 68 },
        { "period": "Ноябрь", "ikop": 71 },
        { "period": "Декабрь", "ikop": 74 },
        { "period": "Январь", "ikop": 78 }
      ],
      "semester": [],
      "stats": {
        "avg": 73,
        "trend": 8,
        "best": { "period": "Январь", "value": 78 },
        "worst": { "period": "Сентябрь", "value": 65 }
      }
    },
    "problemAreas": [
      {
        "discipline": "Физика",
        "teacher": "Иванов И.И.",
        "group": "ПИ21-1",
        "ikop": 58,
        "coverage": 82
      }
    ],
    "topDisciplines": [
      { "name": "Программирование", "ikop": 85 },
      { "name": "Математика", "ikop": 82 },
      { "name": "Английский язык", "ikop": 80 }
    ],
    "topTeachers": [
      { "name": "Петров П.П.", "ikop": 88 },
      { "name": "Сидорова С.С.", "ikop": 85 },
      { "name": "Кузнецов К.К.", "ikop": 83 }
    ],
    "wordCloud": {
      "frequencies": [
        { "word": "практика", "count": 145, "sentiment": "neutral" },
        { "word": "интересно", "count": 98, "sentiment": "neutral" },
        { "word": "непонятно", "count": 56, "sentiment": "negative" }
      ]
    }
  }
}
```

## Возможные улучшения

1. **Реализовать экспорт в Excel и PDF**
   - Установить библиотеки: `npm install xlsx pdfkit`
   - Реализовать генерацию файлов в endpoints

2. **Добавить кэширование**
   - Использовать Redis для кэширования часто запрашиваемых данных

3. **Реализовать "Свободные опросы"**
   - Создать аналогичную аналитику для свободных опросов
   - Добавить категории опросов
   - Статистику по типам опросов

4. **Добавить детальные страницы**
   - При клике на проблемную дисциплину → переход на детальную аналитику
   - При клике на преподавателя → профиль преподавателя
   - При клике на группу → аналитика группы

5. **Добавить уведомления**
   - Настройка оповещений о проблемных областях
   - Email-рассылка отчетов

6. **Добавить сравнительный анализ**
   - Сравнение групп между собой
   - Сравнение семестров
   - Бенчмаркинг

## Зависимости

### Client:
- `react` v19.2.1
- `recharts` v3.6.0 (уже установлен)
- `tailwindcss` v3.4.19 (уже установлен)
- `axios` v1.13.2 (уже установлен)

### Server:
- `mongoose` (для работы с MongoDB)

### Для будущей реализации экспорта:
- `xlsx` - для Excel
- `pdfkit` - для PDF

## Контакты и поддержка

При возникновении вопросов или проблем:
1. Проверьте консоль браузера на наличие ошибок
2. Проверьте консоль сервера
3. Убедитесь, что в базе данных есть данные для отображения

## Примечания

- Дизайн адаптивный и работает на различных размерах экранов
- Используется dark mode из глобального ThemeContext
- Все тексты на русском языке
- Эмоджи НЕ используются в коде (только в комментариях и README)
