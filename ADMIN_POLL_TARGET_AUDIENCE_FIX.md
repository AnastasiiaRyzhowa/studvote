# –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–∞—Ä–≥–µ—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∞—É–¥–∏—Ç–æ—Ä–∏–∏ –≤ –∞–¥–º–∏–Ω—Å–∫–æ–º CreatePoll

## –ü—Ä–æ–±–ª–µ–º–∞

–ê–¥–º–∏–Ω—Å–∫–∏–π CreatePoll.jsx –æ—Ç–ø—Ä–∞–≤–ª—è–ª –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –¥–∞–Ω–Ω—ã—Ö:

```javascript
// ‚ùå –ß–¢–û –û–¢–ü–†–ê–í–õ–Ø–õ–û–°–¨:
{
  target_audience: { type: 'faculty', value: '–§–ò–¢–∏–ê–ë–î' }
}

// ‚úÖ –ß–¢–û –û–ñ–ò–î–ê–ï–¢ BACKEND:
{
  target_groups: [],
  target_faculties: ['–§–ò–¢–∏–ê–ë–î'],
  target_programs: [],
  target_courses: []
}
```

## –†–µ—à–µ–Ω–∏–µ

### 1. Frontend: `/client/src/pages/Admin/CreatePoll.jsx`

#### –î–æ–±–∞–≤–ª–µ–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏ —Ñ–æ—Ä–º–∞—Ç–∞:

```javascript
const convertTargetAudienceToArrays = (targetAudience) => {
  const result = {
    target_groups: [],
    target_faculties: [],
    target_programs: [],
    target_courses: []
  };

  if (!targetAudience || !targetAudience.type || !targetAudience.value) {
    return result;
  }

  switch (targetAudience.type) {
    case 'group':
      result.target_groups = [targetAudience.value];
      break;
    case 'faculty':
      result.target_faculties = [targetAudience.value];
      break;
    case 'program':
      result.target_programs = [targetAudience.value];
      break;
    case 'course':
      result.target_courses = [parseInt(targetAudience.value)];
      break;
  }

  return result;
};
```

#### –û–±–Ω–æ–≤–ª–µ–Ω handleSubmit:

- –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç `target_audience` –≤ –º–∞—Å—Å–∏–≤—ã —á–µ—Ä–µ–∑ `convertTargetAudienceToArrays()`
- –ü—Ä–∞–≤–∏–ª—å–Ω–æ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç `type` –æ–ø—Ä–æ—Å–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ `question_type`
- –î–æ–±–∞–≤–ª–µ–Ω–æ –¥–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏
- –ü—Ä–∞–≤–∏–ª—å–Ω–æ —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç payload —Å –º–∞—Å—Å–∏–≤–∞–º–∏ —Ç–∞—Ä–≥–µ—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### 2. Backend: `/server/src/routes/adminRoutes.js`

#### –û–±–Ω–æ–≤–ª–µ–Ω POST `/api/admin/polls`:

- –ü—Ä–∏–Ω–∏–º–∞–µ—Ç –º–∞—Å—Å–∏–≤—ã `target_groups`, `target_faculties`, `target_programs`, `target_courses`
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç `visibility` –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ü–µ–ª–µ–≤–æ–π –∞—É–¥–∏—Ç–æ—Ä–∏–∏:
  - –ï—Å–ª–∏ —É–∫–∞–∑–∞–Ω—ã –≥—Ä—É–ø–ø—ã ‚Üí `visibility: 'group'`
  - –ï—Å–ª–∏ —É–∫–∞–∑–∞–Ω—ã —Ñ–∞–∫—É–ª—å—Ç–µ—Ç—ã ‚Üí `visibility: 'faculty'`
  - –ï—Å–ª–∏ —É–∫–∞–∑–∞–Ω—ã –ø—Ä–æ–≥—Ä–∞–º–º—ã ‚Üí `visibility: 'program'`
  - –ï—Å–ª–∏ —É–∫–∞–∑–∞–Ω—ã –∫—É—Ä—Å—ã ‚Üí `visibility: 'course'`
  - –ò–Ω–∞—á–µ ‚Üí `visibility: 'public'`
- –í—ã—á–∏—Å–ª—è–µ—Ç `target_count` (—Ü–µ–ª–µ–≤–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ—Ç–≤–µ—Ç–æ–≤) –Ω–∞ –æ—Å–Ω–æ–≤–µ –∞—É–¥–∏—Ç–æ—Ä–∏–∏
- –î–æ–±–∞–≤–ª–µ–Ω–æ –¥–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
- –£–ª—É—á—à–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ Mongoose

#### –û–±–Ω–æ–≤–ª–µ–Ω GET `/api/admin/form-options`:

- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `Promise.all()` –¥–ª—è –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö
- –§–∏–ª—å—Ç—Ä—É–µ—Ç —Ç–æ–ª—å–∫–æ –∞–∫—Ç–∏–≤–Ω—ã—Ö —Å—Ç—É–¥–µ–Ω—Ç–æ–≤ (`is_active: true`)
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –ø–æ–ª–µ `group` –≤–º–µ—Å—Ç–æ `group_name`
- –î–æ–±–∞–≤–ª–µ–Ω–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã—Ö –æ–ø—Ü–∏–π
- –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–ø–∏—Å–æ–∫ –∫—É—Ä—Å–æ–≤ (1-5)

#### –£–¥–∞–ª–µ–Ω –¥—É–±–ª–∏—Ä—É—é—â–∏–π —Ä–æ—É—Ç:

- –£–¥–∞–ª–µ–Ω –ø—Ä–æ—Å—Ç–æ–π –≤–∞—Ä–∏–∞–Ω—Ç GET `/polls` –Ω–∞ —Å—Ç—Ä–æ–∫–µ 133
- –û—Å—Ç–∞–≤–ª–µ–Ω –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π –≤–∞—Ä–∏–∞–Ω—Ç —Å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π –∏ –ø–∞–≥–∏–Ω–∞—Ü–∏–µ–π

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö –≤ –ë–î

–ú–æ–¥–µ–ª—å Poll —É–∂–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –≤—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –ø–æ–ª—è:

```javascript
{
  target_groups: [String],      // ['22–ú–û05', '22–ú–û06']
  target_faculties: [String],   // ['–§–ò–¢–∏–ê–ë–î', '–§–ú–≠–û']
  target_programs: [String],    // ['DevOps', 'Data Science']
  target_courses: [Number],     // [1, 2, 3]
  visibility: String            // 'public', 'group', 'faculty', 'program', 'course'
}
```

## –ß—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

1. ‚úÖ –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –≤—ã–±–∏—Ä–∞–µ—Ç —Ü–µ–ª–µ–≤—É—é –∞—É–¥–∏—Ç–æ—Ä–∏—é —á–µ—Ä–µ–∑ –≤—ã–ø–∞–¥–∞—é—â–∏–µ —Å–ø–∏—Å–∫–∏
2. ‚úÖ –î–∞–Ω–Ω—ã–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –ø—Ä–µ–æ–±—Ä–∞–∑—É—é—Ç—Å—è –≤ –º–∞—Å—Å–∏–≤—ã –ø–µ—Ä–µ–¥ –æ—Ç–ø—Ä–∞–≤–∫–æ–π
3. ‚úÖ Backend –ø—Ä–∞–≤–∏–ª—å–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –º–∞—Å—Å–∏–≤—ã —Ç–∞—Ä–≥–µ—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
4. ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è `visibility`
5. ‚úÖ –í—ã—á–∏—Å–ª—è–µ—Ç—Å—è —Ü–µ–ª–µ–≤–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ—Ç–≤–µ—Ç–æ–≤
6. ‚úÖ –û–ø—Ä–æ—Å—ã –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –∞—É–¥–∏—Ç–æ—Ä–∏–∏ (—á–µ—Ä–µ–∑ `isVisibleTo()` –º–µ—Ç–æ–¥)

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –°–æ–∑–¥–∞–Ω–∏–µ –æ–ø—Ä–æ—Å–∞ –¥–ª—è —Ñ–∞–∫—É–ª—å—Ç–µ—Ç–∞:

```bash
# Frontend –æ—Ç–ø—Ä–∞–≤–∏—Ç:
{
  "title": "–û–ø—Ä–æ—Å –¥–ª—è –§–ò–¢–∏–ê–ë–î",
  "type": "single",
  "target_groups": [],
  "target_faculties": ["–§–ò–¢–∏–ê–ë–î"],
  "target_programs": [],
  "target_courses": []
}

# Backend —Å–æ–∑–¥–∞—Å—Ç –æ–ø—Ä–æ—Å —Å:
{
  "visibility": "faculty",
  "target_faculties": ["–§–ò–¢–∏–ê–ë–î"],
  "max_responses": <–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç—É–¥–µ–Ω—Ç–æ–≤ —Ñ–∞–∫—É–ª—å—Ç–µ—Ç–∞>
}
```

### –°–æ–∑–¥–∞–Ω–∏–µ –æ–ø—Ä–æ—Å–∞ –¥–ª—è –≥—Ä—É–ø–ø—ã:

```bash
# Frontend –æ—Ç–ø—Ä–∞–≤–∏—Ç:
{
  "title": "–û–ø—Ä–æ—Å –¥–ª—è –≥—Ä—É–ø–ø—ã 22–ú–û05",
  "type": "multiple",
  "target_groups": ["22–ú–û05"],
  "target_faculties": [],
  "target_programs": [],
  "target_courses": []
}

# Backend —Å–æ–∑–¥–∞—Å—Ç –æ–ø—Ä–æ—Å —Å:
{
  "visibility": "group",
  "target_groups": ["22–ú–û05"],
  "max_responses": <–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç—É–¥–µ–Ω—Ç–æ–≤ –≤ –≥—Ä—É–ø–ø–µ>
}
```

## –õ–æ–≥–∏ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏

Frontend:
```
üì§ –û—Ç–ø—Ä–∞–≤–∫–∞ –æ–ø—Ä–æ—Å–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–º: {
  title: "...",
  type: "single",
  target_groups: [...],
  target_faculties: [...],
  ...
}
```

Backend:
```
üìä –°–æ–∑–¥–∞–Ω–∏–µ –æ–ø—Ä–æ—Å–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–º: {
  title: "...",
  visibility: "faculty",
  target_groups: [],
  target_faculties: ["–§–ò–¢–∏–ê–ë–î"],
  targetCount: 150
}
```

## –§–∞–π–ª—ã –∏–∑–º–µ–Ω–µ–Ω—ã

1. `/client/src/pages/Admin/CreatePoll.jsx` - –¥–æ–±–∞–≤–ª–µ–Ω–∞ –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è —Ñ–æ—Ä–º–∞—Ç–∞
2. `/server/src/routes/adminRoutes.js` - –æ–±–Ω–æ–≤–ª–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ POST /polls –∏ form-options
