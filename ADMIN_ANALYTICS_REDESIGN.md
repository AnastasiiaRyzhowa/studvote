# 📊 Редизайн аналитики администратора

## Проблема
Сейчас всё смешано в одну кучу: общие метрики, детали по группам, дисциплины, преподаватели. Непонятно где искать конкретную информацию.

## Решение: Табовая структура с контекстными фильтрами

---

## СТРУКТУРА СТРАНИЦЫ АНАЛИТИКИ

### Верхний уровень: Фильтры (всегда видны)
```
[Факультет ▼] [Направление ▼] [Курс ▼] [Группа ▼] [Период: Неделя/Месяц ▼]
                                                    [Кнопка: Сбросить]
```

### Средний уровень: Табы навигации
```
┌──────────────────────────────────────────────────────────────┐
│ [📊 Обзор]  [👥 Группы]  [📚 Дисциплины]  [👨‍🏫 Преподаватели]  [⚖️ Сравнение] │
└──────────────────────────────────────────────────────────────┘
```

---

## ТАБ 1: 📊 ОБЗОР (Overview)

**Назначение:** Быстрый взгляд на общее состояние системы, алерты, рейтинги

**Когда показываем:**
- По умолчанию при входе
- Фильтры применяются (если выбраны), но без глубокой детализации

**Содержимое:**

### 1.1 Карточки верхнего уровня (4 штуки)
```
┌────────────────┬────────────────┬────────────────┬────────────────┐
│  АКТИВНОСТЬ    │ УДОВЛЕТВОРЁН.  │   ПРОБЛЕМЫ     │  НАДЁЖНОСТЬ    │
│     78%        │     4.2 ⭐     │      3         │      85        │
│   ↑ +5%        │   ↑ +0.3       │   ↓ -2         │   → 0          │
│ 320 из 450     │  Из 2847 отв.  │  Требует вним. │   Хорошо       │
└────────────────┴────────────────┴────────────────┴────────────────┘
```

**Показатели:**
- **Активность:** % студентов, ответивших на опросы за период (с учётом фильтров)
- **Удовлетворённость:** Средний балл по всем рейтинговым вопросам
- **Проблемы:** Количество групп/дисциплин/преподавателей с оценкой <3.5 или падением активности >20%
- **Надёжность:** Средний рейтинг надёжности групп (если фильтры выбраны)

### 1.2 Алерты (если есть)
```
⚠️ ТРЕБУЮТ ВНИМАНИЯ:
┌─────────────────────────────────────────────────────────────┐
│ 🔴 Группа Т25-1: активность упала на 35% за 2 недели       │
│ 🔴 Преподаватель Сидоров С.С.: средняя оценка 2.8 ⭐       │
│ 🟡 Дисциплина "Математика": падение с 4.1 до 3.2 за месяц  │
└─────────────────────────────────────────────────────────────┘
```

### 1.3 Динамика активности (график)
```
График по неделям с линией тренда
+ аннотации событий (сессия, каникулы)
```

### 1.4 Топ-3 рейтинги (3 колонки)
```
┌─────────────────┬─────────────────┬─────────────────┐
│  ТОП-3 ГРУППЫ   │ ТОП-3 ДИСЦИПЛ.  │ ТОП-3 ПРЕПОД.   │
├─────────────────┼─────────────────┼─────────────────┤
│ УЦИ24-1: 92%    │ Веб-прогр: 4.6  │ Иванова: 4.8    │
│ ПИ-401: 85%     │ Python: 4.4     │ Петров: 4.5     │
│ Т25-1: 58%      │ Проект-мен: 3.8 │ Сидоров: 3.2    │
└─────────────────┴─────────────────┴─────────────────┘
```

### 1.5 Текстовая аналитика (краткая сводка)
```
Комментариев: 124
Топ-3 темы: Практика (28), Понятность (22), Актуальность (18)
Тональность: 😊 45% | 😐 30% | 😞 25%
```

**Кнопки действий:**
- [Экспорт отчёта] PDF/XLSX
- [Подробнее по группам] → переход на таб "Группы"

---

## ТАБ 2: 👥 ГРУППЫ (Groups)

**Назначение:** Детальная аналитика по группам

**Логика отображения:**

### Если группа НЕ выбрана в фильтрах:
Показываем **таблицу-список всех групп** с возможностью выбора:

```
┌────────────────────────────────────────────────────────────────┐
│ СПИСОК ГРУПП                                                   │
├────────┬──────────┬──────────┬───────────┬─────────┬──────────┤
│ Группа │ Студ.    │ Активн.  │ Удовл.    │ Надёжн. │ Действие │
├────────┼──────────┼──────────┼───────────┼─────────┼──────────┤
│УЦИ24-1 │ 70       │ 92% ↑    │ 4.3 ⭐    │ 95      │[Детали]  │
│ПИ-401  │ 4        │ 85% →    │ 4.0 ⭐    │ 88      │[Детали]  │
│Т25-1   │ 3        │ 58% ↓⚠️  │ 3.2 ⭐    │ 78      │[Детали]  │
└────────┴──────────┴──────────┴───────────┴─────────┴──────────┘

Фильтры действуют: показываются только группы из выбранного факультета/курса
[Сортировка по: Активность / Удовлетворённость / Надёжность]
```

### Если группа ВЫБРАНА в фильтрах:
Показываем **детальную карточку группы с внутренними табами**:

```
┌─────────────────────────────────────────────────────────────────┐
│ АНАЛИТИКА ГРУППЫ: Т25-1                                         │
│ Факультет экономики и бизнеса • 1 курс • 3 студента            │
├─────────────────────────────────────────────────────────────────┤
│ [Обзор] [По дисциплинам] [Динамика] [Надёжность] [Комментарии] │
└─────────────────────────────────────────────────────────────────┘

Содержимое меняется в зависимости от внутреннего таба (как описано ранее)
```

**Внутренние табы группы:**
1. **Обзор:** Общие показатели, проблемы, сильные стороны, состав
2. **По дисциплинам:** Таблица дисциплин с оценками, трендами, проблемами
3. **Динамика:** График активности по неделям с причинами падения
4. **Надёжность:** Текущий рейтинг + история изменений с обоснованиями
5. **Комментарии:** Все текстовые отзывы с фильтрами и тональностью

**Кнопки действий:**
- [Изменить рейтинг надёжности] (открывает диалог)
- [Экспорт данных по группе]
- [Сравнить с другой группой] → переход на таб "Сравнение"

---

## ТАБ 3: 📚 ДИСЦИПЛИНЫ (Subjects)

**Назначение:** Аналитика по конкретным дисциплинам (как их оценивают студенты из разных групп)

**Логика отображения:**

### Если дисциплина НЕ выбрана:
Показываем **список всех дисциплин** (с учётом фильтров по факультету/курсу):

```
┌────────────────────────────────────────────────────────────────┐
│ СПИСОК ДИСЦИПЛИН                                               │
├──────────────────────┬─────────┬──────────┬──────────┬────────┤
│ Дисциплина           │ Препод. │ Оценка   │ Ответов  │ Тренд  │
├──────────────────────┼─────────┼──────────┼──────────┼────────┤
│Программирование Python│Иванова │ 4.6 ⭐   │ 120      │ ↑      │
│Проектный менеджмент  │Петров   │ 4.4 ⭐   │ 98       │ →      │
│Математика            │Сидоров  │ 3.2 ⭐⚠️ │ 87       │ ↓      │
└──────────────────────┴─────────┴──────────┴──────────┴────────┘

[Кликнуть на дисциплину для детального просмотра]
```

### Если дисциплина выбрана (через дополнительный фильтр или клик):
Показываем **детальную аналитику по дисциплине**:

```
┌─────────────────────────────────────────────────────────────────┐
│ АНАЛИТИКА ДИСЦИПЛИНЫ: Математика                                │
│ Преподаватель: Сидоров С.С. • Кафедра математики               │
├─────────────────────────────────────────────────────────────────┤

📊 ОБЩИЕ ПОКАЗАТЕЛИ:
├─ Средняя оценка: 3.2 ⭐ (↓ с 4.1 за месяц) ⚠️
├─ Всего ответов: 87
├─ Охваченных групп: 5
└─ Период: последний месяц

📈 ОЦЕНКИ ПО КРИТЕРИЯМ:
├─ Актуальность темы: 3.5 ⭐
├─ Понятность объяснений: 2.9 ⭐ ⚠️ (проблема!)
├─ Практическая ценность: 3.8 ⭐
└─ Техническое оснащение: 4.2 ⭐

👥 ОЦЕНКИ ПО ГРУППАМ:
┌─────────┬─────────┬──────────┬──────────────────────┐
│ Группа  │ Курс    │ Оценка   │ Активность           │
├─────────┼─────────┼──────────┼──────────────────────┤
│ УЦИ24-1 │ 2       │ 3.5 ⭐   │ 85% (60 из 70)       │
│ ПИ-401  │ 5       │ 2.8 ⭐⚠️ │ 75% (3 из 4)         │
│ Т25-1   │ 1       │ 3.0 ⭐   │ 67% (2 из 3)         │
└─────────┴─────────┴──────────┴──────────────────────┘

💬 КОММЕНТАРИИ (топ проблемы):
1. "Слишком быстро объясняет" (12 упоминаний)
2. "Мало примеров" (8 упоминаний)
3. "Непонятная теория" (6 упоминаний)

💡 РЕКОМЕНДАЦИИ:
⚠️ Срочно: Встреча с преподавателем о методике
📚 Добавить дополнительные материалы/видео
🔄 Снизить темп изложения, больше примеров
```

**Кнопки действий:**
- [Связаться с преподавателем]
- [Экспорт отчёта по дисциплине]
- [Сравнить с другой дисциплиной]

---

## ТАБ 4: 👨‍🏫 ПРЕПОДАВАТЕЛИ (Teachers)

**Назначение:** 
1. Оценки преподавателей от студентов (feedback)
2. Оценки преподавателей о группах (lesson reviews)

**Логика отображения:**

### Если преподаватель НЕ выбран:
Показываем **список всех преподавателей**:

```
┌────────────────────────────────────────────────────────────────┐
│ СПИСОК ПРЕПОДАВАТЕЛЕЙ                                          │
├─────────────────────┬───────────┬─────────┬──────────┬────────┤
│ Преподаватель       │ Кафедра   │ Оценка  │ Дисципл. │ Тренд  │
├─────────────────────┼───────────┼─────────┼──────────┼────────┤
│Иванова И.И.         │ ИТ        │ 4.8 ⭐  │ 3        │ ↑      │
│Петров П.П.          │ Менеджмент│ 4.5 ⭐  │ 2        │ →      │
│Сидоров С.С.         │ Математика│ 3.2 ⭐⚠️│ 1        │ ↓      │
└─────────────────────┴───────────┴─────────┴──────────┴────────┘

[Кликнуть на преподавателя для детального просмотра]
```

### Если преподаватель выбран:
Показываем **детальную карточку с двумя разделами**:

```
┌─────────────────────────────────────────────────────────────────┐
│ АНАЛИТИКА ПРЕПОДАВАТЕЛЯ: Сидоров С.С.                           │
│ Кафедра математики • Стаж: 15 лет                              │
├─────────────────────────────────────────────────────────────────┤

📊 ЧАСТЬ 1: ОЦЕНКИ ОТ СТУДЕНТОВ
─────────────────────────────────
Средняя оценка: 3.2 ⭐ (↓ с 4.0 за семестр) ⚠️
Всего ответов: 87 от студентов

📈 ОЦЕНКИ ПО КРИТЕРИЯМ:
├─ Понятность объяснений: 2.9 ⭐ ⚠️ (проблема!)
├─ Вовлечённость: 3.1 ⭐
├─ Отношение к студентам: 3.8 ⭐
└─ Хотели бы продолжить обучение: 42% (Да)

📚 ОЦЕНКИ ПО ДИСЦИПЛИНАМ:
├─ Математика: 3.2 ⭐ (87 ответов)
└─ Статистика: 3.5 ⭐ (42 ответа)

👥 ОЦЕНКИ ПО ГРУППАМ:
┌─────────┬─────────┬──────────┐
│ Группа  │ Оценка  │ Ответов  │
├─────────┼─────────┼──────────┤
│ УЦИ24-1 │ 3.5 ⭐  │ 60       │
│ ПИ-401  │ 2.8 ⭐⚠️│ 3        │
│ Т25-1   │ 3.0 ⭐  │ 2        │
└─────────┴─────────┴──────────┘

💬 КОММЕНТАРИИ ОТ СТУДЕНТОВ:
Негативные (55%):
- "Слишком быстро объясняет" (12 раз)
- "Мало примеров" (8 раз)
Позитивные (25%):
- "Хорошо знает материал" (5 раз)
Нейтральные (20%)

─────────────────────────────────
📝 ЧАСТЬ 2: ОЦЕНКИ ПРЕПОДАВАТЕЛЯ О ГРУППАХ
─────────────────────────────────
Всего оценок пар: 23
Средняя посещаемость: 78%
Средняя активность групп: 3.8/5

📊 ОЦЕНКИ ПО ГРУППАМ (от преподавателя):
┌─────────┬────────────┬──────────┬──────────────┬──────────┐
│ Группа  │ Посещаем.  │ Активн.  │ Надёжность   │ Послед.  │
├─────────┼────────────┼──────────┼──────────────┼──────────┤
│ УЦИ24-1 │ 92% ↑      │ 4.5/5 ↑  │ 95 (+5)      │ 3 дня    │
│ ПИ-401  │ 75% →      │ 4.0/5 →  │ 88 (0)       │ 5 дней   │
│ Т25-1   │ 58% ↓⚠️    │ 2.5/5 ↓  │ 78 (-5)      │ 2 дня    │
└─────────┴────────────┴──────────┴──────────────┴──────────┘

📝 ПОСЛЕДНИЕ КОММЕНТАРИИ ПРЕПОДАВАТЕЛЯ:
1. Т25-1 (2 дня назад): "Низкая посещаемость, нужна встреча с куратором"
2. УЦИ24-1 (3 дня назад): "Отличная работа группы, все активны"
3. ПИ-401 (5 дней назад): "Стабильная группа, без замечаний"

─────────────────────────────────
💡 РЕКОМЕНДАЦИИ:
⚠️ Срочно: Методическая поддержка по улучшению понятности объяснений
📚 Рассмотреть возможность дополнительных консультаций
🎯 Фокус на группу ПИ-401 (самые низкие оценки)
```

**Кнопки действий:**
- [Связаться с преподавателем]
- [Назначить встречу]
- [Экспорт отчёта]
- [Сравнить с другим преподавателем]

---

## ТАБ 5: ⚖️ СРАВНЕНИЕ (Compare)

**Назначение:** Сравнить любые два среза (группа vs группа, факультет vs факультет, и т.д.)

**Интерфейс:**

```
┌─────────────────────────────────────────────────────────────────┐
│ СРАВНИТЕЛЬНЫЙ АНАЛИЗ                                            │
├─────────────────────────────────────────────────────────────────┤

ВЫБЕРИТЕ ДВА СРЕЗА ДЛЯ СРАВНЕНИЯ:

Срез 1:                              Срез 2:
[Тип: Группа ▼]                      [Тип: Группа ▼]
[Выбор: УЦИ24-1 ▼]                   [Выбор: Т25-1 ▼]

Типы среза: Группа / Факультет / Курс / Дисциплина / Преподаватель

                        [Кнопка: Сравнить]

─────────────────────────────────────────────────────────────────
РЕЗУЛЬТАТЫ СРАВНЕНИЯ:

┌──────────────────────┬──────────────┬──────────────┬──────────┐
│ Метрика              │ УЦИ24-1      │ Т25-1        │ Разница  │
├──────────────────────┼──────────────┼──────────────┼──────────┤
│ Студентов            │ 70           │ 3            │ +67      │
│ Активность           │ 92% ████████ │ 58% █████    │ +34%     │
│ Удовлетворённость    │ 4.3 ⭐       │ 3.2 ⭐       │ +1.1     │
│ Надёжность           │ 95           │ 78           │ +17      │
│ Посещаемость         │ 92%          │ 58%          │ +34%     │
│ Ответов              │ 145          │ 15           │ +130     │
└──────────────────────┴──────────────┴──────────────┴──────────┘

📊 ГРАФИЧЕСКОЕ СРАВНЕНИЕ:
[Радар-чарт с метриками]
[Гистограмма оценок по дисциплинам]

💬 ОБЩИЕ ПРОБЛЕМЫ:
УЦИ24-1: "Больше практики" (28 упоминаний)
Т25-1: "Непонятно объясняет" (8 упоминаний)

💡 РЕКОМЕНДАЦИИ:
- УЦИ24-1: Добавить практические кейсы
- Т25-1: Нужна помощь преподавателю, дополнительные консультации

[Экспорт сравнительного отчёта] PDF | XLSX
```

---

## ИТОГОВАЯ СТРУКТУРА НАВИГАЦИИ

```
Админ панель
└─ Аналитика
   ├─ 📊 Обзор (по умолчанию)
   │  ├─ Карточки верхнего уровня
   │  ├─ Алерты
   │  ├─ График динамики
   │  ├─ Топ-3 рейтинги
   │  └─ Краткая текстовая аналитика
   │
   ├─ 👥 Группы
   │  ├─ Список всех групп (если группа не выбрана)
   │  └─ Детальная карточка группы (если группа выбрана)
   │     ├─ Обзор
   │     ├─ По дисциплинам
   │     ├─ Динамика
   │     ├─ Надёжность
   │     └─ Комментарии
   │
   ├─ 📚 Дисциплины
   │  ├─ Список всех дисциплин (если дисциплина не выбрана)
   │  └─ Детальная карточка дисциплины (если выбрана)
   │     ├─ Общие показатели
   │     ├─ Оценки по критериям
   │     ├─ Оценки по группам
   │     ├─ Комментарии
   │     └─ Рекомендации
   │
   ├─ 👨‍🏫 Преподаватели
   │  ├─ Список всех преподавателей (если не выбран)
   │  └─ Детальная карточка преподавателя (если выбран)
   │     ├─ Оценки от студентов
   │     │  ├─ По критериям
   │     │  ├─ По дисциплинам
   │     │  ├─ По группам
   │     │  └─ Комментарии
   │     └─ Оценки преподавателя о группах
   │        ├─ Посещаемость
   │        ├─ Активность
   │        ├─ Изменения надёжности
   │        └─ Комментарии преподавателя
   │
   └─ ⚖️ Сравнение
      ├─ Выбор двух срезов
      ├─ Таблица сравнения метрик
      ├─ Графическое сравнение
      └─ Рекомендации
```

---

## ПРЕИМУЩЕСТВА НОВОЙ СТРУКТУРЫ

✅ **Логичное разделение:** Каждый таб отвечает за свою сущность  
✅ **Контекстные фильтры:** Работают на всех табах одинаково  
✅ **Глубина детализации:** От общего (Обзор) к конкретному (детали группы)  
✅ **Связность:** Легко переходить между табами (кнопки «Сравнить», «Детали»)  
✅ **Разделение данных студентов и преподавателей:** Всё в одном месте, но разделено логически  
✅ **Понятная навигация:** Сразу ясно где искать информацию  

---

## ПЛАН РЕАЛИЗАЦИИ

1. ✅ Документация структуры
2. ⏳ Обновить `AnalyticsOverview.jsx` → добавить табовую навигацию
3. ⏳ Реализовать таб «Обзор» (упрощённый, без лишних деталей)
4. ⏳ Реализовать таб «Группы» с условным рендерингом (список/детали)
5. ⏳ Реализовать таб «Дисциплины»
6. ⏳ Реализовать таб «Преподаватели» (объединить оценки студентов + оценки препода)
7. ⏳ Реализовать таб «Сравнение»
8. ⏳ Добавить кнопки экспорта на всех табах
9. ⏳ Тестирование с реальными данными
10. ⏳ Полировка UI/UX

---

## ТЕХНИЧЕСКИЕ ДЕТАЛИ

### Бэкенд API (уже есть частично, нужно дополнить):
- ✅ `GET /api/analytics/dashboard` — общая аналитика (для таба Обзор)
- ✅ `GET /api/analytics/filters` — списки для фильтров
- ✅ `GET /api/admin/analytics/group/:id` — детали по группе
- ⏳ `GET /api/analytics/subjects` — список дисциплин
- ⏳ `GET /api/analytics/subject/:id` — детали по дисциплине
- ⏳ `GET /api/analytics/teachers` — список преподавателей
- ⏳ `GET /api/analytics/teacher/:id` — детали по преподавателю (2 части)
- ⏳ `POST /api/analytics/compare` — сравнение двух срезов

### Фронтенд компоненты:
- `AnalyticsOverview.jsx` → переименовать в `AnalyticsPage.jsx` (главная страница с табами)
- `AnalyticsOverviewTab.jsx` → таб «Обзор»
- `AnalyticsGroupsTab.jsx` → таб «Группы» (список + детали)
- `AnalyticsSubjectsTab.jsx` → таб «Дисциплины»
- `AnalyticsTeachersTab.jsx` → таб «Преподаватели»
- `AnalyticsCompareTab.jsx` → таб «Сравнение»

---

## СЛЕДУЮЩИЙ ШАГ

Начать реализацию с обновления `AnalyticsOverview.jsx` → добавить табовую навигацию и заглушки под каждый таб.
